## MapReduce

- 병렬 분산 알고리즘 구현이 가능한 맵리듀스 프레임워크
- 맵리듀스 프레임워크를 사용할 수 있는 하둡 설치 및 맵리듀스 알고리즘 코드를 실행

### 병렬 분산 알고리즘

- Scale-out
  - 아주 많은 값싼 서버들 이용
- Scale-up
  - 적은 수의 값비싼 서버들을 이용
- 데이터 중심 어플리케이션 분야에서는 값싼 서버들을 많이 이용하는 것을 선호
- 고가의 서버들은 가격에 관점에서는 선형으로 성능이 증가하지 않음
- 맵리듀스는 빅데이터를 이용한 효율적인 계산이 가능한 첫 번째 프로그래밍 모델

### MapReduce Framework

- 값싼 컴퓨터들을 모아서 클러스터를 만들고 여기에서 빅 데이터를 처리하기 위한 scalable 병렬 소프트웨어의 구현 쉽게 할 수 있도록 도와주는 간단한 프로그래밍 모델
- 구글의 맵리듀스 또는 오픈소스인 하둡은 맵리듀스 프레임워크의 우수한 구현의 형태
- 드라이버에 해당하는 메인 함수가 Map 함수와 Reduce함수를 호출해서 처리
- 각각의 레코드 또는 튜플이 key, value쌍으로 표현
- 7분

### MapReduce Programming Model

- 함수형 프로그래밍 언어의 형태
- 유저는 3가지 함수를 구현해서 제공해야 함
  1. Main 함수
  2. Map 함수 : (key1,val1) → [(key2,val2)]
  3. Reduce 함수 : (key2,[val2]) → [(key3,val3)]

### MapReduce Phase (3단계로 수행)

- 맵 페이즈
  1. 제일 먼저 수행되며 데이터의 파티션에 병렬 분산으로 호출되어 수행
  2. 각 머신마다 수행된 Mapper는 맵 함수가 입력 데이터의 한 줄 마다 Map 함수를 호출
  3. Map함수는 (Key,value)쌍 형태로 결과를 출력하고 여러 머신에 나누어 보내며 같은 key를 가진 (key,value)쌍은 같은 머신으로 보낸다.
- 셔플링 페이즈
  1. 모든 머신에서 맵 페이즈가 끝나면 시작
  2. 맵 페이즈에서 각각의 머신으로 보낸 (key,value)쌍을 Key를 이용해서 정렬
  3. 각각의 KEY마다 같은 KEY를 가진 (KEY,VALUE)쌍을 모아서 밸류-리스트를 만든 다음에 (key,value-list)형태로 KEY에 따라서 여러 머신에 분산해서 보낸다.
- 리듀스 페이즈
  1. 모든 머신에서 셔플링 페이즈가 다 끝나면 각 머신마다 리듀스 페이즈가 시작
  2. 각각의 머신에서는 셔플링 페이즈에서 해당 머신으로 보낸 각각의(KEY,VLAUE-LIST)쌍마다 리듀스함수가 호출되며 하나의 리듀스 함수가 끝나면 다음 (KEY,VALUE-LIST)쌍에 리듀스 함수가 호출
  3. 출력이 있다면 (KEY,VLAUE)쌍 형태로 출력

### Hadoop

- 아파치 프로젝트의 맵리듀스 프레임워크의 오픈소스
- 하둡 분산 파일 시스템(HDFS)
  1. 빅 데이터 파일을 여러 대의 컴퓨터에 나누어서 저장함
  2. 각 파일은 여러 개의 순차적인 블록으로 저장
  3. 하나의 파일의 각각의 블록은 fault tolerance를 위해서 여러 개로 복사되어 여러 머신의 여기저기 저장됨
     - fault tolerance는 시스템을 구성하는 부품의 일부에서 결함 또는 고장이 발생하여도 정상적 혹은 부분적으로 기능을 수행할 수 있는 것을 말함
  4. 빅 데이터를 수천 대의 값싼 컴퓨터에 병렬 처리하기 위해 분산함
- 주요 구성 요소들
  1. MapReduce - 소프트웨어의 수행을 분산
  2. Hadoop Distributed File System(HDFS) - 데이터를 분산함
- 한 개의 Namenode(master)와 여러 개의 Datanode(slaves)
  1. Namenode
     - 파일 시스템을 관리하고 클라이언트가 파일에 접근할 수 있게 함
  2. Datanode
     - 컴퓨터에 들어있는 데이터를 접근할 수 있게 함

### MapReduce 함수

- 맵 함수
  1. org.apache.hadoop.mapreduce 패키지에 있는 Mapper 클래스를 상속받아서 맵 메서드를 수정한다.
  2. 입력 텍스트 파일에서 라인 단위로 호출되고 입력은 키-밸류(KEY,VALUE-LIST)의 형태
  3. KEY는 입력 텍스트 파일에서 맨 앞 문자를 기준으로 맵 함수가 호출된 해당 라인의 첫 번째 문자까지의 오프셋
  4. VALUE는 텍스트의 해당 라인 전체가 들어있다.
- 리듀스 함수
  1. org.apache.hadoop.mapreduce 패키지에 있는 Reduce 클래스를 상속받아서 reduce 메서드를 수정한다.
  2. 셔플링 페이즈의 출력을 입력으로 받는데 키-밸류(KEY,VALUE-LIST) 형태
  3. VALUE-LIST는 맵 함수의 출력에서 KEY를 갖는 (KEY,VALUE) 쌍들의 VALUE들의 리스트

컴바인 함수

1. 리듀스 함수와 유사한 함수인데 각 머신에서 맵 페이즈에서 맵 함수의 출력 크기를 줄여서 셔플링 페이즈와 리슈트 페이즈의 비용을 줄여주는데 사용